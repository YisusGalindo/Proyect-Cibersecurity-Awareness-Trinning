{% extends 'base.html' %}
{% block title %}Historial - Phishing Suite{% endblock %}
{% block content %}
  <div class="card">
    <h2>üìã Historial de Campa√±as</h2>
    <p>Registro completo de todas las actividades realizadas en el sistema.</p>
  </div>

  <div class="card">
    <h3>üïí Actividades Recientes</h3>
    {% if rows %}
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Acci√≥n</th>
            <th>Campa√±a ID</th>
            <th>Fecha y Hora</th>
            <th>Estado</th>
          </tr>
        </thead>
        <tbody>
          {% for id, action, campaign_id, timestamp in rows %}
          <tr>
            <td><span class="badge">#{{ id }}</span></td>
            <td>
              <span class="action-badge {% if action == 'start' %}success{% elif action == 'stop' %}danger{% elif action == 'report' %}info{% endif %}">
                {% if action == 'start' %}üöÄ Iniciar
                {% elif action == 'stop' %}‚èπÔ∏è Detener
                {% elif action == 'report' %}üìÑ Reporte
                {% else %}{{ action }}
                {% endif %}
              </span>
            </td>
            <td>
              {% if campaign_id %}
                <code>{{ campaign_id }}</code>
              {% else %}
                <span class="text-muted">N/A</span>
              {% endif %}
            </td>
            <td>{{ timestamp }}</td>
            <td><span class="status-completed">‚úÖ Completado</span></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <div class="empty-state">
        <p>üì≠ No hay actividades registradas a√∫n.</p>
        <p>Las acciones aparecer√°n aqu√≠ cuando inicies tu primera campa√±a.</p>
      </div>
    {% endif %}
  </div>

  {% if reports %}
  <div class="card">
    <h3>üìä Reportes Generados</h3>
    <div class="reports-grid">
      {% for report in reports %}
      <div class="report-card">
        <div class="report-icon">üìÑ</div>
        <div class="report-info">
          <h4>{{ report }}</h4>
          <p>Reporte PDF generado</p>
        </div>
        <div class="report-actions">
          <a href="/reports/{{ report }}" class="btn-download" target="_blank">
            üì• Descargar
          </a>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  {% else %}
  <div class="card">
    <h3>üìä Reportes</h3>
    <div class="empty-state">
      <p>üìã No hay reportes disponibles.</p>
      <p>Genera tu primer reporte desde el <a href="/">panel principal</a>.</p>
    </div>
  </div>
  {% endif %}

  <style>
    .badge {
      background: rgba(102, 126, 234, 0.2);
      color: #667eea;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
    }
    
    .action-badge {
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      display: inline-block;
    }
    
    .action-badge.success {
      background: rgba(16, 185, 129, 0.2);
      color: #10b981;
    }
    
    .action-badge.danger {
      background: rgba(239, 68, 68, 0.2);
      color: #ef4444;
    }
    
    .action-badge.info {
      background: rgba(59, 130, 246, 0.2);
      color: #3b82f6;
    }
    
    .status-completed {
      color: #10b981;
      font-size: 12px;
    }
    
    .text-muted {
      color: #6b7280;
      font-style: italic;
    }
    
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: #9ca3af;
    }
    
    .empty-state p {
      margin: 8px 0;
    }
    
    .reports-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 16px;
      margin-top: 16px;
    }
    
    .report-card {
      background: rgba(55, 65, 81, 0.6);
      border-radius: 12px;
      padding: 20px;
      display: flex;
      align-items: center;
      gap: 16px;
      transition: transform 0.3s ease;
    }
    
    .report-card:hover {
      transform: translateY(-2px);
    }
    
    .report-icon {
      font-size: 32px;
      opacity: 0.8;
    }
    
    .report-info {
      flex: 1;
    }
    
    .report-info h4 {
      margin: 0 0 4px 0;
      color: #e6edf3;
      font-size: 14px;
    }
    
    .report-info p {
      margin: 0;
      color: #9ca3af;
      font-size: 12px;
    }
    
    .btn-download {
      background: linear-gradient(45deg, #10b981, #059669);
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      text-decoration: none;
      font-size: 12px;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    
    .btn-download:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
    }
    
    @media (max-width: 768px) {
      .reports-grid {
        grid-template-columns: 1fr;
      }
      
      .report-card {
        flex-direction: column;
        text-align: center;
      }
    }
  </style>
{% endblock %}